<%= paginate @pages, :remote => true %>
<%= info_page @pages, @total_entries %>
<%= per_page_links @pages, true %>
<table class='list'>
  <thead>
    <th><%= sortable 'id' %></th>
    <th><%= sortable 'date_begin_at', t("date_param", :param => t("register"))%></th>
    <th><%= sortable 'date_end_at', t("date_param", :param => t("publication"))%></th>
    <th><%= sortable 'title', t("title") %></th>
    <th><%= sortable 'author_id', t("author") %></th>
    <th><%= sortable 'category', t("category") %></th>
    <th><%= sortable 'type', t("type") %></th>
    <% if check_permission(PagesController, [:toggle_field]) %>
      <th><%= t"cover" %></th>
      <th><%= t"publish" %></th>
    <% end %>
    <th></th>
  </thead>
  <tbody>
    <% @pages.each do |page| %>
      <tr>
        <td><%= page.id %></td>
        <td><%= l page.created_at, :format => :short %></td>
        <td><%= l page.date_begin_at, :format => :short %></td>
        <%# TODO verificar se é possível melhorar o link abaixo %>
        <td><%= link_to page.title, {:controller => controller.controller_name, :action => 'show', :id => page.id} %></td>
        <td><%= page.user.first_name ? ("#{page.user.first_name} #{page.user.last_name}") : page.user.login %></td>
        <td><%= page.category %></td>
        <td><%= t"#{page.type.downcase}.one" %></td>
        <% if check_permission(PagesController, [:toggle_field]) %>
          <td align="center"><%= raw toggle_field(page, "front") %></td>
          <td align="center"><%= raw toggle_field(page, "publish") %></td>
        <% end %>
        <td>
          <%= raw make_menu(page, :except => "show") %>
          <% if check_permission(PagesController, ["sort"]) %>
            <%# FIXME drag and drop não está funcionando %>
            <div class='handle icon icon-drag'><%= t("move") %></div>
          <% end %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
