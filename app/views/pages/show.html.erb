<fieldset>
  <div id="pages">
    <% unless @page.repository.nil? %>
      <%= link_to image_tag("#{@page.repository.archive.url}", :align => "right"), @page.repository.archive.url, :alt => @page.repository.description, :title => @page.repository.description %>
    <% end %>

    <p> <h1> <%= @page.title %> </h1> </p>
    <p> <i><%= @page.user.login %>, <%= l @page.created_at, :format => :short  %>.</i> </p>
    <h2> <%= raw @page.summary %> </h2>
    <h3> <%= raw @page.text %> </h3>
    <p> <h3> <%= @page.url.nil? ? @page.source : link_to(@page.source, @page.url) %> </h3> </p>

    <% unless @page.repositories.empty? %>
      <table class="list">
        <thead bgcolor = white>
          <th><%= t"related_files" %></th>
          <th><%= t"size" %></th>
          <th> MD5 </th>
        </thead>
        <tbody>    
        <% @page.repositories.each do |repository| %>
          <tr class="<%= cycle 'odd', 'even' %>">
          <td><%= link_to repository.description, repository.archive.url %></td>
          <td><%= repository.archive_file_size.to_i/1024 %> KB</td>
          <td><% remove_trash = "#{repository.archive.url}".index('?') - 1 %>
          <%= Digest::MD5.file(File.open("public"+"#{repository.archive.url}"[0..remove_trash], "rb")) %></td>
          </tr>
        <% end; reset_cycle %>
        </tbody>
      </table>
      <br />
    <% end %>

    <%= link_to t("edit"), edit_site_page_path(@site, @page) %> | <%= link_to t("back"), :back %>
  </div>
</fieldset>
