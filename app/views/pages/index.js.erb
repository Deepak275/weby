$("#pages tbody").
html("<%= escape_javascript(render partial: 'page', collection: @pages) %>")

$(".page_info_paginator").
replaceWith("<%= escape_javascript(info_page @pages) %>")

$(".paginator").
replaceWith("<%= escape_javascript(paginate @pages, remote: true) %>").
show()

$(".per_page_paginator").
replaceWith("<%= escape_javascript(per_page_links @pages, remote: true) %>")

$('th').each(function(index, element){
  $(element).find('a').attr('href', function(index, value){
    return value.
    replace(/per_page=[^&]*/i, 'per_page=<%= params[:per_page] %>');
  });
});

$('th a.current').removeClass('current asc desc');

var tableColumn = $('a[data-column="<%= escape_javascript(params[:sort]) %>"]')
var invertDirections = {
  'asc': 'desc',
  'desc': 'asc'
};

var atualDirection = tableColumn.attr('href').match(/direction=([^&]*)/i)[1];

tableColumn.attr('href', function(index, value){
  return value.
  replace(/direction=[^&]*/i, 'direction='+invertDirections[atualDirection]).
  replace(/per_page=[^&]*/i, 'per_page=<%= params[:per_page] %>');
});

tableColumn.
removeClass(atualDirection).
addClass("current "+atualDirection);
