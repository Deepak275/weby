<%= form_for @feedback,
              :url => @feedback.id.nil? ? site_feedbacks_path(@site) : site_feedback_path(@site),
              :method => @feedback.id.nil? ? 'post' : 'put',
              :builder => SemanticFormBuilder do |f| %>
  <% if @feedback.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@feedback.errors.count, "error") %> prohibited this feedback from being saved:</h2>
      <ul>
      <% @feedback.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%# TODO Fazer a implementação usando f.select %>
  <%#= f.select(:name,Groups.find(:all, :conditions => 'status = 1', :order => 'created_at DESC').collect{|p| [ p.service, p.id ]}) %>
  <% unless @groups.empty? %>
    <%= f.fields_for :group_ids do |group_id| %>
      <%= group_id.select nil, options_for_select(@groups.collect{|p| [ p.name, p.id ]}), :required => true, :label => t(:group, :count => 1) %>
    <% end %>
    <%#= select_tag "feedback[group_ids][]", options_for_select(@groups.collect{|p| [ p.name, p.id ]}), :required => true, :label => t(:group, :count => 1) %>
  <% end %>

  <%= f.text_field :name, :label => t("name") %>
  
  <%= f.text_field :email, :label => t("email") %>
  
  <%= f.text_field :subject, :label => t("subject") %>

  <%= f.text_area :message, :label => t("message") %>

  <%=  f.hidden_field :site_id, :value => @site.id %>

  <%= f.submit t("send") %>

<% end %>
